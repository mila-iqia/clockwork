# Clockwork Developer Guide

Details about the implementation go here.

## Note about formatting

You need to run `black` before committing your code or else the CI will reject your pull request.
To do so, you simply have to call `black .` in the root directory.
This is a python module that can be installed with `python3 -m pip install black`.

## Note about translation

Each time a word or sentence which will be displayed to the user is added, it
has to be translated. For this purpose, you can follow the next steps:

1. **Wrap the string to be translated into `gettext`**. This is done in the code, where the string is added.
    1. You first have to import the function `gettext` as follows:
        ```
        from flask_babel import gettext
        ```
    2. Then, use is on the sentence you want to translate:
        ```
        gettext("String to translate")
        ```
2. **Generate the translation template file (`.pot` file)**. This is done through the command line.
    ```
    pybabel extract -F clockwork_web/babel.cfg -o clockwork_web/static/locales/messages.pot clockwork_web/
    ```
3. **Update the pre-existing translation file(s) (`.po` file(s))**. This is done through the command line.
    ```
    pybabel update -i clockwork_web/static/locales/messages.pot -d clockwork_web/static/locales/
    ```
4. **Fill the missing translations in the `.po` file(s)**. This is done manually: in our case, the only `.po` file to be filled is the French one, which is located at `clockwork_web/static/locales/fr/LC_MESSAGES/messages.po`. It should contain something like:
    ```
    #: clockwork_web/path_to_updated_file.py:64
    msgid "String to translate"
    msgstr ""
    ```
    You simply have to fill the empty string at the end with the desired translation.

The compiled translation files should then be automatically generated by the Docker container `clockwork_dev` or `clockwork_web`.


## Other sections of the documentation

More details can be found in the following sections:
* [Obtaining the state of the Slurm clusters](slurm_state.md)
* [Retrieving GPU data](gpu.md)
* [Internationalization](internationalization.md)
